\documentclass[a4paper,pdftex,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage[english,slovene]{babel} 
\usepackage{amsmath,amsfonts,amsthm,amssymb,mathrsfs,empheq} % Math packages
\usepackage{mathtools}
\usepackage{dsfont}
\usepackage[pdftex]{graphicx}
%\usepackage{makeidx}

\usepackage[version=3]{mhchem} %kemija

\newcommand*\diff{\mathop{}\!\mathrm{d}}	%za integrale
\newcommand*\Diff[1]{\mathop{}\!\mathrm{d^#1}}	%odstranim presledke


\renewcommand{\vec}[1]{\boldsymbol{\mathbf{#1}}}                                        
\newcommand{\ihat}[0]{\boldsymbol{\mathbf{\oldhat{\textbf{\i}}}}} % pokončna j in i (j i n i
\newcommand{\iu}{{i\mkern1mu}}	    %imaginarno število
\DeclarePairedDelimiterX{\norm}[1]{\lVert}{\rVert}{#1} %norma

\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header

%\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
%\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)

\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{	
\normalfont \normalsize 
\textsc{Modelska analiza 1} \\ [25pt] % Your university, school and/or department name(s)
%\horrule{0.2pt} \\[0.4cm] % Thin top horizontal rule
\huge 8. naloga\\ % The assignment title
%\horrule{0.2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Tina Klobas} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}

\maketitle % Print the title

\section{Opis problema}
Pri tej nalogi opazujemo različne algoritme za generacijo naključnih števil. Za preverjanje
teh algoritmov se bomo uporabili test Kolmogorov-Smirnova in $\chi^2$ test.

\subsubsection*{Kolmogorov-Smirnova test}
Zvezno kumulativno funkcijo izračunamo kot integral verjetnostne gostote
\begin{equation} \label{kumul}
    F(x) = \int_{-\infty}^{x} f(t) \diff t.
\end{equation}
Definiramo še empirično kumulativno funkcijo zapišemo kot
\begin{equation} \label{empiric}
    F_n(x) = \frac{z}{N}
\end{equation}
kjer je $z$ število vseh točk, ki so manjše od $x$, $N$ pa število vseh točk. Tako za 
testiranje točnosti funkcije izračunamo maksimalno odstopanje od izmerkov 
\begin{equation}\label{supremum}
    D_n = sup \left| F(x) - F_n(x) \right|.
\end{equation}
Za slučanja števila, ki so porazdeljena po porazdelitvenem zakonu velja za odmike
\begin{equation}\label{KS}
    P(D \geq x) = 2 \sum_{j=1}^{\infty} (-1)^{j-1} \mathrm{e}^{-2j^2 D_n^2}.
\end{equation}

\subsubsection*{$\chi^2$ test:}

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------

\section{Slučajna gaussovska števila}
Za generacijo slučajnih gaussovskih števil lahko uporabimo dva algoritma. 
\subsubsection*{Box-Muller:}
Naključni števili $x_1,x_2$ zberemo z~enotskega intervala $U=[0,1]$. Potem sta števili
\begin{align}
    y_1 &= \sqrt{-2 \log x_1} \cos 2\pi x_2 \quad \mathrm{in} \\
    y_2 &= \sqrt{-2 \log x_1} \sin 2\pi x_2
\end{align}
naključni števili, ki sledita gaussovski porazdelitvi.

\subsubsection*{Konvolucijski generator:}
Ta metoda temelji na centralnem limitnem izreku, ki pravi, da vsaka vsota ali povprečje,
če je število členov dovolj veliko, je približno normalno porazdeljena. Ta izek velja
za slučajne neodvisne spremenljivke, porazdeljene po enakem matematičnem zakonu s~končno
disperzijo. Konvolucijski generator tako jemlje enakomerno porazdeljena števila $x_i$ 
z~intervala $[0,6]$ in jih sešteva med sabo
\begin{equation}\label{konvolucija}
    \sum_{i=1}^{N} x_i -6.
\end{equation} 
Izkaže se, da je dovolj, če vzamemo $N=12$ členov vsote, kar vidimo tudi na 
grafu~\ref{slika1}.
\begin{figure}    
    \resizebox{0.98\linewidth}{!}{\input{graf1.tex}}
    \caption{Primer konvolucije za različno število členov v~vsoti in $1000$ naključnimi 
    števili.}
    \label{slika1}
\end{figure}
\begin{figure}    
    \resizebox{0.98\linewidth}{!}{\input{graf2.tex}}
    \caption{Gaussovi porazdelitvi za oba algoritma s~$1000$ naključnimi števili.}
    \label{slika2}
\end{figure}
\begin{figure}    
    \resizebox{1\linewidth}{!}{\input{graf3.tex}}
    \caption{Gaussovi porazdelitvi za oba algoritma za različne količine števil. Zraven
    je narisana še Gaussovka.}
    \label{slika3}
\end{figure}


%----------------------------------------------------------------------------------------
%	PROBLEM 2
%----------------------------------------------------------------------------------------
\section{Prostorska porazdelitev}
Radi bi sestavili generator števil, enakomerno porazdeljenih po enotski sferi;
\begin{equation}
    \frac{\mathrm{d}P}{\mathrm{d} V} =  \frac{\mathrm{d}^3P}{r^2\mathrm{d}r 
    \mathrm{d}(cos\theta) \mathrm{d}\phi}
\end{equation}

\begin{figure}    
    \resizebox{1\linewidth}{!}{\input{graf4.tex}}
    \caption{Porazdelitev vseh treh prostorskih koordinat.}
    \label{slika4}
\end{figure}






\end{document}
