\documentclass[a4paper,pdftex,11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage[english,slovene]{babel} 
\usepackage{amsmath,amsfonts,amsthm,amssymb,mathrsfs,empheq} % Math packages
\usepackage{mathtools}
\usepackage{dsfont}
\usepackage{wrapfig}
\usepackage[pdftex]{graphicx}
%\usepackage{makeidx}
\usepackage{url}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tabularx}
\usepackage{float}

\usepackage[version=3]{mhchem} %kemija

\DeclarePairedDelimiter{\evdel}{\langle}{\rangle}   %pricakovana vrednost


\renewcommand{\vec}[1]{\boldsymbol{\mathbf{#1}}}                                        
\newcommand{\ihat}[0]{\boldsymbol{\mathbf{\oldhat{\textbf{\i}}}}} % pokončna j in i (j i n i
\newcommand{\iu}{{i\mkern1mu}}	    %imaginarno število
\DeclarePairedDelimiterX{\norm}[1]{\lVert}{\rVert}{#1} %norma

\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header

%\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
%\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)

\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{	
\normalfont \normalsize 
\textsc{Modelska analiza 1} \\ [25pt] % Your university, school and/or department name(s)
%\horrule{0.2pt} \\[0.4cm] % Thin top horizontal rule
\huge 11. naloga - Stohastični populacijski modeli\\ % The assignment title
%\horrule{0.2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Tina Klobas} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}

\maketitle % Print the title

\section{Opis problema}
V~nalogi se bomo ukvarjali s~Poissonovimi stohastičnimi procesi. S~tem se realni situaciji
približamo z~numeričnimimi približki tako, da na vsakem koraku integracije dopuščamo 
odmike od modela v~obliki napake. Na vsakem koraku tako izžrebamo naključno število, 
porazdeljeno okoli predvidene po Poissonovi porazdelitvi
\begin{equation}
    \frac{\lambda^x \mathrm{e}^{-\lambda}}{x \, !},
\end{equation}
kar bomo označevali z~$\mathcal{P}(\lambda)$.
%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------
\section{Eksponentni model izumrtja}
Radi bi delali statistiko časov izumrtja za preprost eksponentni model ($\beta = 
1/\text{enota časa}$)
\begin{equation} \label{izumiranje}
    \frac{\mathrm{d} N }{N} = - \beta \mathrm{d}t \quad \rightarrow \quad
    N(t) = N_0 \mathrm{e}^{-\beta t}
\end{equation}
pri različnih začetnih velikostih populacije $N_0$. Zanima nas kako je ta čas povezan
z~velikostjo časovnega koraka $\Delta t$ in koliko se problem bliža modelu, ki vključuje
rojstva in smrti ($\beta_r =4\beta, \, \beta_s = 5\beta$).\\
Model~\ref{izumiranje} spravimo v~numerično obliko, tako da na vsakem koraku izračunamo
\begin{equation}
    N ( t+ \Delta t) = N(t) - \mathcal{P}(\beta N \Delta t).
\end{equation}

\subsubsection*{Velika začetna populacija: $N_0=250$}
Za fiksno začetno vrednost spreminjamo velikosti korakov $\Delta t = \{ 0.001, \, 0.01, \\
\, 0.1, \, 0.25, \, 0.5, \, 1 \}$.
Na grafu~\ref{slika1} je prikazanih $100$ ponovitev za korak $\Delta t = 0,01$ in njihovo 
povprečje (ki sovpada z~eksponentno funkcijo). Za različne korake podobno izračunamo
povprečja nekaj ponovitev, kar je prikazano na grafu~\ref{slika2}. Z~obeh grafov je vidno, 
da je bolje jemati manjše korake, če se želimo približati realnemi vrednosti.
S~tem ko zmanjšamo korak, tudi zožamo poissonovo funkcijo $\lambda = \beta N(t) \Delta t$
in s~tem zmanjšamo šum, oziroma nihanje okoli povprečne vrednosti.
\begin{figure}    
    \centering
    \resizebox{0.75\linewidth}{!}{\input{graf2.tex}}
    \caption{$100$ poskusov in njihova povprečna vrednost.}
    \label{slika1}
\end{figure}

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf4.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf5.tex}} 
    \end{minipage}

    \caption{Povprečne vrednosti $100$ poskusov za različne $\Delta t$ za $N_0=250$.}
    \label{slika2}
\end{figure}

\subsubsection*{Majhna začetna populacija: $N_0=25$}

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf6.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf7.tex}} 
    \end{minipage}
    \caption{Povprečne vrednosti $100$ poskusov za različne $\Delta t$ za $N_0=25$.}
    \label{slika3}
\end{figure}

Podobno kot smo v~prejšnjem primeru videli, tudi tukaj vidimo s~pomočjo 
grafov~\ref{slika3}, da je bolje jemati krajše čase. 
\pagebreak

\subsection{Časi izumrtja}
Zanimivo je opazovati čase izumrtja populacije. Na grafih~\ref{slika4} je prikazana
porazdelitev v~odvisnosti od različnih korakov $\Delta t$ za $N=10000$ poskusov. Na prvi 
pogled lahko že potrdimo prešnje grafe, da koraki, večji od $\Delta t = 0,1$, ne dajo 
dovolj natančnega rezultata in se precej razlikujejo od ostalih. Pri sliki za $N_0=250$ je 
odstopanje med različnimi koraki veliko manjše. Celoten graf za manjšo populacijo je 
pomaknjen v~levo, saj manjša populacija prej zamre. Pri tem grafu tudi opazimo, da razen
histogram za $\Delta t =1$, so vsi ostali veliko manj razlikujejo.

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf9.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf8.tex}} 
    \end{minipage}
    \caption{Histograma časov izumrtja za različno začetno vrednost populacije. Model
    je osnoven, samo s~parametrom, ki zmanjšuje populacijo.}
    \label{slika4}
\end{figure}

\subsubsection*{Rojstva in smrti}
Sedaj spremenimo model in upoštevamo rojstva in smrti (in dodatna parametra $\beta_r = 
4\beta$, $\beta_s = 5\beta$)
\begin{equation}
    \frac{\mathrm{d} N}{\mathrm{d} t} (t) = - \beta_s t + \beta_r t = -5\beta  + 4 \beta
    = -\beta t
\end{equation}
enačba je enaka kot prej, le da sedaj dovolimo, da s~stohastičnim računanjem dovolimo
tudi občasno rast populacije, kar je tudi bolj podobno realnosti.
Stohastična enačba je tako:
\begin{equation}
    N (t + \Delta t) = N(t) - \mathcal{P}(\beta_s N \Delta t) + 
    \mathcal{P}(\beta_r N \Delta t).
\end{equation}
S~tem razčlenjenim členom smrti, ki dopušča tudi rojevanje smo tudi dopustili večjo
razpršenost stohastičnega modela, kar tudi vidimo na grafu~\ref{slika5}, ki je veliko
bolj razšpršen, kot ekvivalenten graf~\ref{slika1}.

\begin{figure}    
    \centering
    \resizebox{0.75\linewidth}{!}{\input{graf12.tex}}
    \caption{$100$ poskusov in njihova povprečna vrednost.}
    \label{slika5}
\end{figure}
Na grafih~\ref{slika6} je zopet prikazana porazdelitev časov izumrtja za različne
časovne korake in spet ugotovimo, da se velikih korakov ne splača uporabljati.

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf11.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf10.tex}} 
    \end{minipage}
    \caption{Histograma časov izumrtja za različno začetno vrednost populacije. Model
    dopušča ločena parametra rodnosti in smrtnosti.}
    \label{slika6}
\end{figure}
Na sliki~\ref{slika7} se bolje vidi primerjava med obema modeloma, kjer se tudi dobro
opazi, da je tudi čas izumrtja populacije nekoliko bolj razpršen kot prvi model. Poleg
tega pa populacija prej izgine, kar je posledica, da sistem bolj moten in vanj vnašamo več
šuma. Časi izumrtja s~tega grafa so \\
\\
\begin{tabularx}{\textwidth}{ |X|X|X| }
    \hline
    $\quad$ & $N_0 = 250$ & $N_0 = 25$ \\ 
    \hline 
    Združen model: & $t = 4,9$ & $t = 3,01$ \\ 
    \hline 
    Ločen model: & $t = 3,68$ & $t = 1,65$ \\ 
    \hline
\end{tabularx}

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf14.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf13.tex}} 
    \end{minipage}
    \caption{Primerjava histogramov za oba modela in pri obeh začetnih vrednostih $N_0$,
    pri koraku $\Delta t=0,01$.}
    \label{slika7}
\end{figure}
\pagebreak
%----------------------------------------------------------------------------------------
%	PROBLEM 2
%----------------------------------------------------------------------------------------
\section{Matrika prehodov}
Prejšnji problem lahko zapišemo tudi z~matriko prehodov. Za trenutno situacijo lahko 
zapišemo vektor stanja: $\vec{x}(t) = (x_0,x_1,x_2,...,x_{N_0})$. Prehod na vsakem časovnem
koraku lahko zapišemo
\begin{equation}
    \vec{x} (t+\Delta t) = M \vec{x} (t)
\end{equation}
oziroma
\begin{equation}
    \vec{x} (p \Delta t) = M^p \vec{x} (0),
\end{equation}
kjer je bilo začetno stanje modela $\vec{x}(0) = (0,0,0,\dots, 1)$ z~enko na $N_0$-tem
mestu. Vrednost komponente vektorja $x_i$ predstavlja verjetnost, da bo sistem v~$i$-tem 
stanju ob času $p \Delta t$. Komponente matrike $M$ so razvoji Poissonove funkcije za majhne
časovne korake in predstavljajo verjetnosti za dogodke v~sistemu (imamo 1 smrt, 
1 rojstvo, ...). Matrika ima tako tridiagonalno obliko
\begin{equation}
    M = 
    \begin{bmatrix}
	1 - (R_0 + S_0)\Delta t  & S_1\Delta t	& 0 \\
	R_0\Delta t  & 1 - (R_1 + S_1)\Delta t & S_2\Delta t & \dots \quad \\
	0 & R_1\Delta t  & 1 - (R_2 + S_2)\Delta t \\
	& \vdots & & \ddots
    \end{bmatrix}
\end{equation}
kjer so $R_n = \beta n$ verjetnosti za rojstva, $S_n = \beta n$ pa za smrti.
\pagebreak
%----------------------------------------------------------------------------------------
%	PROBLEM 3
%----------------------------------------------------------------------------------------
\section{Model plen-plenilec}
Model življenja populacij lisic in zajcev smo že opazovali, sedaj pa parameter, ki je 
skrbel, da so se populacije manjšale/večale, tako kot pri prvi nalogi, razdelimo na smrtnost
in rodnost. Parametre rojstev zajcev označimo z~$\rho_z$ in lisic z~$\rho_l$, smrtnosti 
pa $\sigma_z$ in $\sigma_l$. Tako imamo sklopljeni enačbi
\begin{align}
    \dot{Z} &= \rho_z Z - \sigma_z Z - \gamma Z L \\
    \dot{L} &= \rho_l L - \sigma_l L + \delta Z L.
\end{align}
Na začetku imamo stanje z~$Z_0=200$ zajci in $L_0=50$ lisicami. Razmerje rodnost/smrtnost
za zajce je $\rho_z/\sigma_z = 5/4$ in za lisice $\rho_l/\sigma_l = 4/5$, oziroma
$\rho_z = 5\alpha, \, \sigma_z = 4\alpha$ in $\rho_l = 4\beta, \, \sigma_l = 5\beta$. 
Preostala parametra nastavimo tako, da sta $\gamma = \alpha /L_0$ in $\delta = \beta/Z_0$.
Tako dobimo stohastični enačbi za populaciji lisic in zajcev:
\begin{align}
    Z_{n+1} &= Z_{n} + \mathcal{P}(5 \alpha Z_n \Delta t) - \mathcal{P}(4 \alpha Z_n 
    \Delta t) - \mathcal{P}( \frac{\alpha}{L_0} Z_n L_n \Delta t) \\
    L_{n+1} &= L_{n} + \mathcal{P}(4 \beta L_n \Delta t) - \mathcal{P}(5 \beta L_n 
    \Delta t) + \mathcal{P}( \frac{\beta}{Z_0} Z_n L_n \Delta t)
\end{align}

\begin{figure}    
    \begin{minipage}{\textwidth} 
	\centering 
	\resizebox{0.75\textwidth}{!}{\input{graf16.tex}} 
    \end{minipage}
    \begin{minipage}{\textwidth} 
	\centering
	\resizebox{0.75\textwidth}{!}{\input{graf15.tex}} 
    \end{minipage}
    \caption{Graf $Z(t)$ in $L(t)$ za $\beta=\alpha=1$. Spodaj je prikazan fazni diagram
    $Z(L)$.}
    \label{slika8}
\end{figure}
Potek numerične rešitve enačb je prikazan na sliki~\ref{slika8}. Vidimo, da sta populaciji
na začetku v~ravnovesni legi in po nekaj korakih padeta iz ravnovesja in začneta nihati.

\begin{figure}    
    \centering
    \resizebox{0.75\linewidth}{!}{\input{graf17.tex}}
    \caption{Prikaz časov izumrtja, povprečenih po 25 poskusih, za različne $\alpha$ in
    $\beta$. Premik med sosednjimi vrednosti je $0,1$.}
    \label{slika9}
\end{figure}

\end{document}
